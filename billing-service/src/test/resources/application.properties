# ===========================================
# Test Configuration - H2 In-Memory Database
# ===========================================

quarkus.application.name=billing-service-test
quarkus.http.test-port=8085

# ===========================================
# Disable DevServices
# ===========================================
quarkus.devservices.enabled=false
quarkus.datasource.devservices.enabled=false
quarkus.kafka.devservices.enabled=false

# ===========================================
# H2 In-Memory Database Configuration
# ===========================================
quarkus.datasource.db-kind=h2
quarkus.datasource.username=test
quarkus.datasource.password=test
quarkus.datasource.jdbc.url=jdbc:h2:mem:testdb;DB_CLOSE_DELAY=-1;MODE=PostgreSQL;DATABASE_TO_LOWER=TRUE;DEFAULT_NULL_ORDERING=HIGH

# ===========================================
# Hibernate Configuration for Tests
# ===========================================
quarkus.hibernate-orm.database.generation=drop-and-create
quarkus.hibernate-orm.log.sql=false
quarkus.hibernate-orm.sql-load-script=no-file
quarkus.hibernate-orm.dialect=org.hibernate.dialect.H2Dialect

# ===========================================
# Logging Configuration
# ===========================================
quarkus.log.level=WARN
quarkus.log.category."com.basit.billing".level=INFO
quarkus.log.console.enable=true
quarkus.log.console.format=%d{HH:mm:ss} %-5p [%c{2.}] %s%e%n

# Suppress noisy logs
quarkus.log.category."io.quarkus".level=WARN
quarkus.log.category."io.netty".level=WARN
quarkus.log.category."org.hibernate".level=WARN
quarkus.log.category."org.jboss".level=WARN

# ===========================================
# OpenAPI/Swagger (Disabled for Tests)
# ===========================================
quarkus.swagger-ui.always-include=false
mp.openapi.scan.disable=true

# ===========================================
# Health Checks and Metrics (Disabled for Tests)
# ===========================================
quarkus.health.extensions.enabled=false
quarkus.smallrye-health.ui.enable=false
quarkus.micrometer.enabled=false
quarkus.micrometer.export.prometheus.enabled=false

# ===========================================
# Scheduler (Disabled for Tests)
# ===========================================
quarkus.scheduler.enabled=false

# ===========================================
# Transaction Configuration
# ===========================================
quarkus.transaction-manager.default-transaction-timeout=30

# ===========================================
# HTTP Configuration
# ===========================================
quarkus.http.body.handle-file-uploads=true
quarkus.http.limits.max-body-size=10M
quarkus.http.cors=false

# ===========================================
# Jackson Configuration
# ===========================================
quarkus.jackson.fail-on-unknown-properties=false
quarkus.jackson.write-dates-as-timestamps=false
quarkus.jackson.serialization-inclusion=non-null

# ===========================================
# Test Optimization
# ===========================================
quarkus.arc.remove-unused-beans=false
quarkus.live-reload.instrumentation=false
quarkus.banner.enabled=false
quarkus.test.flat-class-path=true

# ===========================================
# Kafka Test Configuration
# ===========================================
mp.messaging.outgoing.invoice-created.connector=smallrye-in-memory
mp.messaging.outgoing.invoice-created.merge=true

mp.messaging.outgoing.payment-processed.connector=smallrye-in-memory
mp.messaging.outgoing.payment-processed.merge=true

mp.messaging.outgoing.payment-failed.connector=smallrye-in-memory
mp.messaging.outgoing.payment-failed.merge=true

mp.messaging.outgoing.refund-issued.connector=smallrye-in-memory
mp.messaging.outgoing.refund-issued.merge=true

mp.messaging.outgoing.insurance-claim-submitted.connector=smallrye-in-memory
mp.messaging.outgoing.insurance-claim-submitted.merge=true

mp.messaging.outgoing.payment-reminder-sent.connector=smallrye-in-memory
mp.messaging.outgoing.payment-reminder-sent.merge=true