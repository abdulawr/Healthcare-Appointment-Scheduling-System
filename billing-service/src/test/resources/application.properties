# ===========================================
# Test Configuration - Direct PostgreSQL Connection
# ===========================================
# Location: src/test/resources/application.properties

# Application Configuration
quarkus.application.name=billing-service-test
quarkus.http.test-port=8085

# ===========================================
# CRITICAL: Disable ALL DevServices and Testcontainers
# ===========================================
quarkus.devservices.enabled=false
quarkus.datasource.devservices.enabled=false
quarkus.kafka.devservices.enabled=false

# ===========================================
# Direct PostgreSQL Connection
# ===========================================
# Uses your existing Docker PostgreSQL or local PostgreSQL
quarkus.datasource.db-kind=postgresql
quarkus.datasource.username=patient_user
quarkus.datasource.password=patient_pass
quarkus.datasource.jdbc.url=jdbc:postgresql://localhost:5432/billing_db_test

# Alternative if using different credentials:
# quarkus.datasource.username=postgres
# quarkus.datasource.password=postgres
# quarkus.datasource.jdbc.url=jdbc:postgresql://localhost:5432/postgres

# ===========================================
# Hibernate Configuration for Tests
# ===========================================
quarkus.hibernate-orm.database.generation=drop-and-create
quarkus.hibernate-orm.log.sql=false
quarkus.hibernate-orm.sql-load-script=no-file

# ===========================================
# Logging Configuration
# ===========================================
quarkus.log.level=WARN
quarkus.log.category."com.basit.billing".level=INFO
quarkus.log.console.enable=true
quarkus.log.console.format=%d{HH:mm:ss} %-5p [%c{2.}] %s%e%n

# Suppress noisy logs
quarkus.log.category."io.quarkus".level=WARN
quarkus.log.category."io.netty".level=WARN
quarkus.log.category."org.hibernate".level=WARN
quarkus.log.category."org.jboss".level=WARN

# ===========================================
# OpenAPI/Swagger (Disabled for Tests)
# ===========================================
quarkus.swagger-ui.always-include=false
mp.openapi.scan.disable=true

# ===========================================
# Health Checks and Metrics (Disabled for Tests)
# ===========================================
quarkus.health.extensions.enabled=false
quarkus.smallrye-health.ui.enable=false
quarkus.micrometer.enabled=false
quarkus.micrometer.export.prometheus.enabled=false

# ===========================================
# Scheduler (Disabled for Tests)
# ===========================================
quarkus.scheduler.enabled=false

# ===========================================
# Transaction Configuration
# ===========================================
quarkus.transaction-manager.default-transaction-timeout=30

# ===========================================
# HTTP Configuration
# ===========================================
quarkus.http.body.handle-file-uploads=true
quarkus.http.limits.max-body-size=10M
quarkus.http.cors=false

# ===========================================
# Jackson Configuration
# ===========================================
quarkus.jackson.fail-on-unknown-properties=false
quarkus.jackson.write-dates-as-timestamps=false
quarkus.jackson.serialization-inclusion=non-null

# ===========================================
# Test Optimization
# ===========================================
quarkus.arc.remove-unused-beans=false
quarkus.live-reload.instrumentation=false
quarkus.banner.enabled=false
quarkus.test.flat-class-path=true


# ========================================
# Kafka Test Configuration
# ========================================

# Use in-memory connectors for tests (no real Kafka needed)
mp.messaging.outgoing.invoice-created.connector=smallrye-in-memory
mp.messaging.outgoing.invoice-created.merge=true

mp.messaging.outgoing.payment-processed.connector=smallrye-in-memory
mp.messaging.outgoing.payment-processed.merge=true

mp.messaging.outgoing.payment-failed.connector=smallrye-in-memory
mp.messaging.outgoing.payment-failed.merge=true

mp.messaging.outgoing.refund-issued.connector=smallrye-in-memory
mp.messaging.outgoing.refund-issued.merge=true

mp.messaging.outgoing.insurance-claim-submitted.connector=smallrye-in-memory
mp.messaging.outgoing.insurance-claim-submitted.merge=true

mp.messaging.outgoing.payment-reminder-sent.connector=smallrye-in-memory
mp.messaging.outgoing.payment-reminder-sent.merge=true